---
description: 关于您资金的真相
---

# 价格预言机：关于您资金的真相

一个错误的价格源可能会破坏整个协议。虚假价格波动导致仓位被清算，漏洞被利用导致数百万资金流失，用户因恶意更新而损失一切。

Ripe 不依赖任何单一来源。我们按照优先顺序检查  Chainlink、Pyth、Stork  和  Curve，并采用第一个有效价格。如果某个预言机失效，我们会立即回退到下一个。

您的抵押品价值来自当时最可靠的来源。

## 为什么定价在  Ripe  中如此重要

每个关键协议操作都依赖于准确的定价：

- **借款能力**：抵押品的价值决定了您可以借入多少  GREEN
- **清算安全性**：当仓位出现风险时，价格波动会触发清算
- **赎回价值**：直接赎回将  GREEN  兑换为  1  美元的抵押品
- **稳定池利润**：清算折扣根据当前市场价格计算
- **利率**：动态利率会根据  GREEN  的市场价格做出反应

鉴于风险如此之大，我们建立了一个既强大又透明的定价体系。

## 多预言机优势

    资产价格请求流程：

    您的资产（例如 ETH）
        ↓
    价格聚合器（Price Desk）
        ↓
    1. 检查优先级预言机（首先检查 Chainlink）
    2. 如果没有价格，检查辅助预言机
    3. 返回第一个找到的有效价格
        ↓
    准确的美元价值

Ripe  不依赖单一的价格源，而是整合了多个独立的预言机提供商：

此设计具有以下优势：

- **无单点故障**：如果  Chainlink  发生故障，Pyth  仍可提供价格
- **资产灵活性**：不同的预言机支持不同的资产
- **成本优化**：仅将昂贵的预言机用于关键资产
- **面向未来**：可无缝添加新的预言机提供商

## 我们的预言机提供商

### 1. Chainlink（主要）

去中心化价格源的行业标准：

- **覆盖范围**：主要加密资产（ETH、BTC、稳定币、蓝筹资产）
- **可靠性**：在去中心化金融（DeFi）领域经过实战验证，保障数十亿美元资产安全
- **更新频率**：根据资产波动性而定
- **信任模型**：基于声誉的去中心化节点运营商

Chainlink  凭借其久经考验的业绩和广泛的应用，成为我们大多数主流资产的主要预言机。

### 2. Curve  池（专门）

来自最大的稳定币流动性池的直接定价：

- **覆盖范围**：稳定币、Curve LP  代币、GREEN  交易对
- **可靠性**：基于实际可交易流动性
- **特殊功能**：实时监控  GREEN  的锚定
- **信任模型**：链上自动做市商状态，具备抗操纵性

**对  GREEN  稳定至关重要**：Curve  价格源维护着  “Green  参考池”  数据，该数据直接影响  [动态利率](../core-protocol/02-borrowing.md#动态利率)。通过对  GREEN/USDC  池余额进行加权快照，协议可以检测到  GREEN  交易低于锚定价时，并自动调整借贷成本以恢复平衡。这形成了一个强大的反馈循环——当  GREEN  走弱时，更高的利率会激励借款人购买  GREEN  进行偿还，从而加强锚定。

### 3. Pyth  网络（高频）

来自机构提供商的亚秒级价格更新：

- **覆盖范围**：广泛涵盖股票、外汇、大宗商品及加密货币
- **可靠性**：专业做市商提供数据
- **更新频率**：可根据需要每时段更新
- **信任模型**：聚合自多个机构数据源

适用于需要频繁更新或  Chainlink  未涵盖的资产。

### 4. Stork  网络（新兴）

具有独特功能的下一代预言机：

- **覆盖范围**：不断扩大的  DeFi  资产选择
- **可靠性**：创新的加密认证模型
- **更新频率**：按需更新，精度达纳秒级
- **信任模型**：拥有股份的去中心化发布者提供额外冗余，并支持新增资产

### 5.  蓝筹收益价格（专门）

主要协议的生息代币定制定价：

- **覆盖范围**：aTokens（Aave）、cTokens（Compound）、Morpho  仓位、Euler  等
- **可靠性**：直接集成协议合约
- **特殊功能**：正确处理弹性供应和收益累积
- **信任模型**：基于底层协议的会计准则

**双层定价**：该预言机将实时基础资产价格（来自  Chainlink  或其他主要预言机）与加权份额价格/汇率快照相结合。例如，对  Morpho USDC  仓位进行定价：

- **基础  USDC  价格**：从  Chainlink  实时获取（1.00  美元）
- **Morpho  份额价格**：时间加权平均值（例如，每股  1.05 USDC）
- **最终仓位价值**：$1.00 × 1.05 = $1.05  每股

**操纵保护**：只有汇率使用加权快照——基础资产价格保持实时。这可以防止攻击者通过闪电贷或临时价格飙升来操纵生息代币的汇率，同时确保抵押品能够立即对基础资产的市场变动做出反应。快照还包括汇率的向上偏差限制，逐步纳入突然升值，而不是立即接受。

## 过时价格保护

过时价格存在风险。以下是我们的防范措施：

### 全球过时阈值

- **默认值**：大多数资产为  3600  秒（1  小时）
- **对波动性资产的限制更严格**
- **对  USDC  等稳定资产放宽限制**

### 每个预言机的配置

每个预言机都可以设置自定义过时限制：

- **Chainlink**：使用轮次时间戳
- **Pyth/Stork**：使用发布时间戳
- **Curve**：始终为最新（直接从池状态读取）
- **蓝筹收益**：基于快照，延迟最小

### 当价格过时会发生什么？

1. **主预言机失效**：系统自动检查辅助预言机。
2. **所有预言机失效**：操作可配置为以下两种情况之一：

- 使用最后已知价格（适用于非关键操作）
- 拒绝交易（用于清算等关键操作）
  3. **无数据源可用**：无数据源的新资产无法用于借贷。

## 价格优先系统

    优先级顺序（可配置）：
    1. Chainlink（最值得信赖的主要资产）
    2. Curve 池（用于稳定币和 LP 代币）
    3. Pyth 网络（Chainlink 资产的备份）
    4. Stork 网络（额外冗余）
    5. 蓝筹收益价格（用于生息代币）

并非所有的预言机都是相同的。我们的优先级系统可确保使用最佳的价格来源。

治理可根据以下因素调整优先级：

- 预言机的可靠性记录
- 更新的  Gas  费用
- 资产特定考虑
- 市场条件

## 安全措施

### 时间锁定更改

- **新增预言机**：延迟  24  小时
- **预言机优先级更改**：延迟  12  小时
- **数据源更新**：6  小时延迟
- **紧急禁用**：即时（由治理多签执行）

### 故障安全机制

- **自动回退**：自动回退到辅助预言机
- **暂停功能**：暂停受损数据源的功能
- **资金回收**：恢复被卡住的更新费用
- **治理覆盖**：治理覆盖功能

## 通过验证建立信任

您的贷款协议不会告诉您以下信息：它们可能只使用一个预言机，若稍微高级一些可能使用两个。

Ripe  连接到四个独立的价格来源，并可即时切换。主预言机出现故障？我们已经使用了备份。无需延迟。无需人工干预。没有单点故障。

这不是偏执，而是能够应对预言机故障的协议与无法应对预言机故障的协议之间的区别。

当您的主要预言机出现故障（而这终将发生时），您的仓位仍会继续定价。

这不是一个功能。这是生存。

---

_有关技术实现细节，请参阅：_

- [_价格聚合器技术文档_](https://docs.ripe.finance/technical-docs/pricing/pricedesk) –  预言机聚合系统
- [_Chainlink  价格_](https://docs.ripe.finance/technical-docs/pricing/chainlinkprices) – Chainlink  整合
- [_Curve  价格_](https://docs.ripe.finance/technical-docs/pricing/curveprices) –  基于自动做市商的定价和  GREEN  监控
- [_Pyth  价格_](https://docs.ripe.finance/technical-docs/pricing/pythprices) –  高频预言机更新
- [_Stork  价格_](https://docs.ripe.finance/technical-docs/pricing/storkprices) –  去中心化价格认证
- [_蓝筹收益价格_](https://docs.ripe.finance/technical-docs/pricing/bluechipyieldprices) –  生息代币估值
